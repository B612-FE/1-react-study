# 2ì£¼ì°¨

## React Developer Tools

ê°œë°œì„ ë„ì™€ì£¼ëŠ” í¬ë¡¬ì˜ extension 

ì„¤ì¹˜ ì ˆì°¨

1) í¬ë¡¬ì— ì›¹ ìŠ¤í† ì–´ ê²€ìƒ‰

2) í¬ë¡¬ ì›¹ ìŠ¤í† ì–´ì—ì„œ react developer tools ê²€ìƒ‰

3) ìµœìƒë‹¨ì— ëœ¨ëŠ” ê²ƒ í´ë¦­ í›„ í¬ë¡¬ì— ì„¤ì¹˜ (ì œê³µìê°€ facebook)

4) í¬ë¡¬ì˜ ì˜¤ë¥¸ìª½ ìƒë‹¨ ì  ì„¸ê°œ (ì˜µì…˜) í´ë¦­ > ë„êµ¬ ë”ë³´ê¸° > í™•ì¥í”„ë¡œê·¸ë¨ 

5) react developer toolsì˜ switch on

6) react developer toolsì˜ ì„¸ë¶€ì •ë³´ í˜ì´ì§€ì— ì ‘ì† í›„ â€˜ì‚¬ì´íŠ¸ ì•¡ì„¸ìŠ¤â€™ > ëª¨ë“  ì‚¬ì´íŠ¸ì—ì„œ 

â€˜íŒŒì¼ urlì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ í—ˆìš©â€™> switch on 

ì‹œí¬ë¦¿ ëª¨ë“œì—ì„œ ê°œë°œí•˜ëŠ” ê²½ìš° â€˜ì‹œí¬ë¦¿ ëª¨ë“œì—ì„œ í—ˆìš©â€™ >switch on

â‡’ ë¦¬ì•¡íŠ¸ ì•±ì„ ì‹¤í–‰í•˜ê³  ê°œë°œì ë„êµ¬ì—ì„œ react developer toolsì˜ ê¸°ëŠ¥ í™•ì¸

- componentì˜ tabì„ í´ë¦­í•˜ë©´ ìš°ë¦¬ê°€ ë§Œë“  ì»´í¬ë„ŒíŠ¸ì˜ ê³„ì¸µêµ¬ì¡°ë¥¼ í•´ì„í•´ì„œ ë³´ì—¬ì¤Œ
- ì–´ë–¤ propsë¥¼ ë°›ì•˜ëŠ”ì§€, ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œì˜ í‚¤ ê°’, state, ì‚¬ìš©í•˜ê³  ìˆëŠ” hook ë“±ì„ ë³´ì—¬ì¤Œ

## ìµœì í™”1 - useMemo

**êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ê²ƒ** 

í˜„ì¬ ì¼ê¸° ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì œì‘í•˜ê³  í•´ë‹¹ í•¨ìˆ˜ê°€ ì¼ê¸° ë°ì´í„°ì˜ ê¸¸ì´ê°€ ë³€í™”í•˜ì§€ ì•Šì„ ë•Œ ê°’ì„ ë‹¤ì‹œ ê³„ì‚°í•˜ì§€ ì•Šë„ë¡ í•˜ê¸°

**í•™ìŠµëª©í‘œ**

Memoization ì´í•´í•˜ê¸° 

**Memoizationì´ë€?** 

ì´ë¯¸ ì—°ì‚° í•œ ê²ƒì˜ ê²°ê³¼ë¥¼ ê¸°ì–µí•´ë‘ì—ˆë‹¤ê°€ ë™ì¼í•œ ê³„ì‚°ì„ ì‹œí‚¤ë©´ ë‹¤ì‹œ ì—°ì‚°í•˜ì§€ ì•Šê³  ê¸°ì–µí•´ë‘ì—ˆë˜ ë°ì´í„°ë¥¼ ë°˜í™˜ í•˜ê²Œ í•˜ëŠ” ë°©ë²• 

= ì‹œí—˜ ë³¼ ë•Œ, ì´ë¯¸ í‘¼ ë¬¸ì œëŠ” ë‹¤ì‹œ í’€ì§€ ì•Šê³  ë‹µì„ ì•„ëŠ” ê²ƒê³¼ ìœ ì‚¬

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled.png)

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%201.png)

ë‹¨ê³„1>data stateê°€ ê°€ì§„ ì¼ê¸° ì¤‘ì—ì„œ ê¸°ë¶„ ì¢‹ì€ ì¼ê¸°ì˜ ê°œìˆ˜, ê¸°ë¶„ì´ ë‚˜ìœ ì¼ê¸°ì˜ ê°œìˆ˜, ê¸°ë¶„ì´ ì¢‹ì€ ì¼ê¸°ì˜ ë¹„ìœ¨ì„ êµ¬í•˜ëŠ” í•¨ìˆ˜ ì‘ì„±

```jsx
import { useState, useRef, useEffect } from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const App = () => {
  const [data, setData] = useState([]);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());
    console.log(res);
    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    setData(initData);
  };

  useEffect(() => {
    getData();
  }, []);

  const onCreate = (author, content, emotion) => {
    const created_date = new Date().getTime();
    const newItem = {
      author,
      content,
      emotion,
      created_date: created_date,
      id: dataId.current,
    };
    dataId.current += 1;
    setData([newItem, ...data]);
  };

  const onEdit = (targetId, newContent) => {
    setData(
      data.map((it) =>
        it.id === targetId ? { ...it, content: newContent } : it
      )
    );
  };

  const onRemove = (targetId) => {
    console.log(targetId);
    const newDiaryList = data.filter((it) => it.id !== targetId);
    setData(newDiaryList);
  };

  const getDiaryAnalysis = () => {
    console.log("ì¼ê¸° ë¶„ì„ ì‹œì‘");

    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100;
    return { goodCount, badCount, goodRatio };
  };

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis();
  return (
    <div>
      <DiaryEditor onCreate={onCreate} />
      <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
      <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
      <DiaryList diaryList={data} onRemove={onRemove} onEdit={onEdit} />
    </div>
  );
};
export default App;
```

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%202.png)

ì½˜ì†”ì— ì¼ê¸° ë¶„ì„ ì‹œì‘ì´ 2ë²ˆ ì°í˜.

ì²˜ìŒì— ë§ˆìš´íŠ¸ë  ë•Œ getDataAnalysis í•¨ìˆ˜ê°€ ìˆ˜í–‰ë˜ì–´ ì½˜ì†”ì— 1ë²ˆ ì°íŒë‹¤.

apië¥¼ ë¶ˆëŸ¬ì˜¤ê³  setDataí•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ dataì˜ ê°’ì´ ë³€í•˜ë©´ App ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚˜ì„œ ì½˜ì†”ì— í•œ ë²ˆ ë” ì°íŒë‹¤.

what if? ì¼ê¸°ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•œë‹¤ë©´?

â†’ getDataAnalysis í•¨ìˆ˜ê°€ ë˜ í˜¸ì¶œë˜ëŠ” ì¼ì´ ë°œìƒ 

emotionê³¼ ì „í˜€ ìƒê´€ ì—†ëŠ” ì¼ê¸°ì˜ contentê°€ ë°”ë€ ê±´ë° App ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ìœ¼ë¡œ  getDataAnalysisê°€ í•œ ë²ˆ ë” ì‹¤í–‰ë¨.

â‡’memoization ì´ í•„ìš”í•¨.

ì˜ì¡´ì„± ë°°ì—´ì˜ ê°’ì´ ë³€í•  ë•Œì—ë§Œ í•¨ìˆ˜ê°€ ë‹¤ì‹œ ì‹¤í–‰ë¨.

ë‹¨ê³„2> useMemoë¥¼ ì‚¬ìš©í•´ì„œ ìµœì í™” (ë¶ˆí•„ìš”í•œ ì—°ì‚° ë°©ì§€)

```jsx
import { useState, useRef, useEffect, useMemo } from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const App = () => {
  const [data, setData] = useState([]);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());
    console.log(res);
    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    setData(initData);
  };

  useEffect(() => {
    getData();
  }, []);

  const onCreate = (author, content, emotion) => {
    const created_date = new Date().getTime();
    const newItem = {
      author,
      content,
      emotion,
      created_date: created_date,
      id: dataId.current,
    };
    dataId.current += 1;
    setData([newItem, ...data]);
  };

  const onEdit = (targetId, newContent) => {
    setData(
      data.map((it) =>
        it.id === targetId ? { ...it, content: newContent } : it
      )
    );
  };

  const onRemove = (targetId) => {
    console.log(targetId);
    const newDiaryList = data.filter((it) => it.id !== targetId);
    setData(newDiaryList);
  };

  const getDiaryAnalysis = useMemo(() => {
    console.log("ì¼ê¸° ë¶„ì„ ì‹œì‘");

    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100;
    return { goodCount, badCount, goodRatio };
  }, [data.length]);

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis; //getDiaryAnalysis()ê°€ ì•„ë‹˜ì— ì£¼ì˜
  return (
    <div>
      <DiaryEditor onCreate={onCreate} />
      <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
      <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
      <DiaryList diaryList={data} onRemove={onRemove} onEdit={onEdit} />
    </div>
  );
};
export default App;
```

ìµœì í™”í•˜ê³  ì‹¶ì€ (ë©”ëª¨ì´ì œì´ì…˜í•˜ê³  ì‹¶ì€) í•¨ìˆ˜ë¥¼ useMemoë¡œ ê°ì‹¸ê³  ì˜ì¡´ì„± ë°°ì—´ì— ì ì ˆí•œ ê°’ì„ ë„£ì–´ì¤€ë‹¤. ì˜ì¡´ì„± ë°°ì—´ì— ë„£ì–´ì¤€ ê°’ì´ ë³€í•  ë•Œë§Œ ì—°ì‚°ì´ ë‹¤ì‹œ ìˆ˜í–‰ë¨.

ì£¼ì˜í•  ì ì€ useMemoëŠ” callback í•¨ìˆ˜ì˜ returnê°’ì„ returní•˜ê¸° ë•Œë¬¸ì— í•¨ìˆ˜ í˜•íƒœë¡œ ê°’ì„ ì „ë‹¬í•˜ë©´ ì•ˆëœë‹¤ëŠ” ê²ƒì´ë‹¤.

## ìµœì í™”2 - ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš©

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%203.png)

ìœ„ ì‚¬ì§„ê³¼ ê°™ì€ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ê°€ ìˆë‹¤ê³  ê°€ì •. 

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%204.png)

setCount(10)ì½”ë“œê°€ ì‹¤í–‰ë˜ë©´ stateì˜ countê°€ ë°”ë€Œê³ , stateê°€ ë°”ë€Œì—ˆê¸° ë•Œë¬¸ì— Appì´ ë¦¬ë Œë”ë§ ëœë‹¤ â†’ Appì˜ ìì‹ ì»´í¬ë„ŒíŠ¸ì¸ CountViewì™€ TextViewë„ ë¦¬ë Œë”ë§

ê·¸ëŸ¬ë‚˜ textë§Œ propìœ¼ë¡œ ë°›ëŠ” TextViewëŠ” ë¦¬ë Œë”ë§ ë  í•„ìš”ê°€ ì—†ìŒ.

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%205.png)

í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì— ì—…ë°ì´íŠ¸ ì¡°ê±¸ì„ ê±¸ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ = React.memo

**React.memoë€?** - ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ ( ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì ¸ì™€ì„œ ìƒˆ ì»´í¬ë„ŒíŠ¸ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ ) 

ë˜‘ê°™ì€ propì„ ë°›ìœ¼ë©´ ë¦¬ë Œë”ë§í•˜ì§€ ì•ŠìŒ. (ë¬¼ë¡  ìê¸° ìì‹ ì˜ stateê°€ ë°”ë€Œë©´ ë¦¬ë Œë”ë§ ë¨, ì˜¤ì§ ë¶€ëª¨ componentì— ì˜í•œ ë¦¬ë Œë”ë§Œ React.memoì— ì˜í•´ ì‘ë™)

```jsx
const MyComponent = React.memeo(funciton MyComponent(props) {
});
```

ìµœì í™”ê°€ í•„ìš”í•œ ì½”ë“œ

```jsx
import { useState, useEffect } from "react";

const TextView = ({ text }) => {
  useEffect(() => {
    console.log(`Update :: Text : ${text}`);
  });
  return <div>{text}</div>;
};

const CountView = ({ count }) => {
  useEffect(() => {
    console.log(`Update :: Count : ${count}`);
  });
  return <div>{count}</div>;
};

const OptimizeTest = () => {
  const [count, setCount] = useState(1);
  const [text, setText] = useState("");

  return (
    <div style={{ padding: 50 }}>
      <div>
        <h2>count</h2>
        <CountView count={count} />
        <button onClick={() => setCount(count + 1)}>+</button>
      </div>
      <div>
        <h2>text</h2>
        <TextView text={text} />
        <input value={text} onChange={(e) => setText(e.target.value)} />
      </div>
    </div>
  );
};
export default OptimizeTest;
```

count ê°’ì´ ë³€í•˜ê±°ë‚˜ text ê°’ì´ ë³€í•  ë•Œë§ˆë‹¤ ë‘˜ ì¤‘ ì–´ëŠ ê°’ì´ ë³€í•˜ë˜ ìƒê´€ ì—†ì´ ì½˜ì†”ì— countì™€ textì˜ ê°’ì´ ëª¨ë‘ ì°í˜.

â‡’ React.memo ì ìš©

```jsx
import React, { useState, useEffect } from "react";

const TextView = React.memo(({ text }) => {
  useEffect(() => {
    console.log(`Update :: Text : ${text}`);
  });
  return <div>{text}</div>;
});

const CountView = React.memo(({ count }) => {
  useEffect(() => {
    console.log(`Update :: Count : ${count}`);
  });
  return <div>{count}</div>;
});

const OptimizeTest = () => {
  const [count, setCount] = useState(1);
  const [text, setText] = useState("");

  return (
    <div style={{ padding: 50 }}>
      <div>
        <h2>count</h2>
        <CountView count={count} />
        <button onClick={() => setCount(count + 1)}>+</button>
      </div>
      <div>
        <h2>text</h2>
        <TextView text={text} />
        <input value={text} onChange={(e) => setText(e.target.value)} />
      </div>
    </div>
  );
};
export default OptimizeTest;
```

countì˜ ê°’ì´ ë°”ë€ŒëŠ” ê²½ìš° console.log(`Update :: Count : ${count}`);ë§Œ ì‹¤í–‰ë˜ê³ ,

textì˜ ê°’ì´ ë°”ë€ŒëŠ” ê²½ìš° console.log(`Update :: Text : ${text}`);ë§Œ ì‹¤í–‰ëœë‹¤.

ë˜ ë‹¤ë¥¸ ì‹¤ìŠµ ì½”ë“œ

```jsx
import React, { useState, useEffect } from "react";

const CounterA = React.memo(({ count }) => {
  useEffect(() => {
    console.log(`CounterA Updated - count: ${count}`);
  });
  return <div>{count}</div>;
});
const CounterB = React.memo(({ obj }) => {
  useEffect(() => {
    console.log(`CounterB Updated - count: ${obj.count}`);
  });
  return <div>{obj.count}</div>;
});

const OptimizeTest = () => {
  const [count, setCount] = useState(1);
  const [obj, setObj] = useState({ count: 1 });

  return (
    <div style={{ padding: 50 }}>
      <div>
        <h2>counter A</h2>
        <CounterA count={count} />
        <button
          onClick={() => {
            setCount(count);
          }}
        >
          A button
        </button>
      </div>
      <div>
        <h2>counter B</h2>
        <CounterB obj={obj} />
        <button
          onClick={() => {
            setObj({ count: obj.count });
          }}
        >
          B button
        </button>
      </div>
    </div>
  );
};
export default OptimizeTest;
```

A buttonì„ ëˆŒëŸ¬ë„ count (type : number)ì˜ ê°’ì´ ë³€í•˜ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ countê¸° ë•Œë¬¸ì— ì½˜ì†”ì— ì•„ë¬´ ê²ƒë„ ì°íˆì§€ ì•ŠìŒ

But, B buttonë„ ë§ˆì°¬ê°€ì§€ë¡œ objì˜ count ê°’ì€ ë³€í•˜ì§€ ì•Šì§€ë§Œ ì½˜ì†”ì— `CounterB Updated - count: 1`ì´ ì°í˜. 

â‡’ ê°ì²´ì™€ ê°™ì€ ë¹„ì›ì‹œíƒ€ì…ì˜ ìë£Œí˜•ì€ ì–•ì€ ë¹„êµ(ì£¼ì†Œì— ì˜í•œ ë¹„êµ)ë¥¼ í•˜ê¸° ë•Œë¬¸!

â‡’ ê°ì²´ë¥¼ propìœ¼ë¡œ ë„˜ê¸°ëŠ” ê²½ìš°, React.memo()ì— ë¹„êµí•¨ìˆ˜ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê²¨ì„œ ìœ„ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŒ

```jsx
import React, { useState, useEffect } from "react";

const CounterA = React.memo(({ count }) => {
  useEffect(() => {
    console.log(`CounterA Updated - count: ${count}`);
  });
  return <div>{count}</div>;
});
const CounterB = ({ obj }) => {
  useEffect(() => {
    console.log(`CounterB Updated - count: ${obj.count}`);
  });
  return <div>{obj.count}</div>;
};

const areEqual = (prevProps, nextProps) => {
  if (prevProps.obj.count === nextProps.obj.count) {
    return true; //ì´ì „ í”„ë¡­ê³¼ í˜„ì¬ í”„ë¡­ì´ ê°™ìŒ -> ë¦¬ë Œë”ë§ x
  }
  return false; //ì´ì „ í”„ë¡­ê³¼ í˜„ì¬ í”„ë¡­ì´ ë‹¤ë¦„ -> ë¦¬ë Œë”ë§ ã…‡
};
const MemoizedCounterB = React.memo(CounterB, areEqual);

const OptimizeTest = () => {
  const [count, setCount] = useState(1);
  const [obj, setObj] = useState({ count: 1 });

  return (
    <div style={{ padding: 50 }}>
      <div>
        <h2>counter A</h2>
        <CounterA count={count} />
        <button
          onClick={() => {
            setCount(count);
          }}
        >
          A button
        </button>
      </div>
      <div>
        <h2>counter B</h2>
        <MemoizedCounterB obj={obj} />
        <button
          onClick={() => {
            setObj({ count: obj.count });
          }}
        >
          B button
        </button>
      </div>
    </div>
  );
};
export default OptimizeTest;
```

## ìµœì í™”3 - useCallback

ë‹¨ê³„ 1> ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ê°€ ìµœì í™” ëŒ€ìƒì¸ì§€ ì°¾ì•„ë‚´ê¸°

<aside>
ğŸ’¡ React Developer Tools ì˜ ê¸°ëŠ¥ ì´ìš© â†’ ê°œë°œìë„êµ¬ â†’ì»´í¬ë„ŒíŠ¸ â†’ ì„¤ì • â†’ Highlight updates when components render ì²´í¬

</aside>

ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ê°€ ë³€ë™ë˜ê³  ìˆëŠ”ì§€ ê¹œë¹¡ì—¬ì„œ ì•Œë ¤ì£¼ëŠ” ê¸°ëŠ¥

ì‹¤ìŠµ ì½”ë“œì— ì ìš© â†’ DiaryListì—ì„œ ì¼ê¸°ë¥¼ ì‚­ì œí•˜ë©´ DiaryEditorë„ ê°™ì´ ê¹œë¹¡ì„.

â†’ìµœì í™” ëŒ€ìƒ

DiaryEditorë¥¼ ìµœì í™”

```jsx
import { React, useRef, useState } from "react";

const DiaryEditor = ({ onCreate }) => {
	useEffect(() => {
    console.log("ë‹¤ì´ì–´ë¦¬ ì—ë””í„° ë Œë”");
  });
  const authorInput = useRef();
  const contentInput = useRef();

  const [state, setState] = useState({
    author: "",
    content: "",
    emotion: 1,
  });

  const handleChangeState = (e) => {
    setState({ ...state, [e.target.name]: e.target.value });
  };

  const handleSubmit = () => {
    if (state.author.length < 1) {
      authorInput.current.focus();
      return;
    }
    if (state.content < 5) {
      contentInput.current.focus();
      return;
    }
    onCreate(state.author, state.content, state.emotion);
    alert("ì €ì¥ ì™„ë£Œ");
    setState({ author: "", content: "", emotion: 1 });
  };

  return (
    <div className="DiaryEditor">
      <h2>ì˜¤ëŠ˜ì˜ ì¼ê¸°</h2>
      <div>
        <input
          ref={authorInput}
          name="author"
          value={state.author}
          onChange={handleChangeState}
        />
      </div>
      <div>
        <textarea
          ref={contentInput}
          name="content"
          value={state.content}
          onChange={handleChangeState}
        />
      </div>
      <div>
        <span>ì˜¤ëŠ˜ì˜ ê°ì • ì ìˆ˜ : </span>
        <select
          name="emotion"
          value={state.emotion}
          onChange={handleChangeState}
        >
          <option value={1}>1</option>
          <option value={2}>2</option>
          <option value={3}>3</option>
          <option value={4}>4</option>
          <option value={5}>5</option>
        </select>
      </div>
      <div>
        <button onClick={handleSubmit}>ì¼ê¸° ì €ì¥í•˜ê¸°</button>
      </div>
    </div>
  );
};
export default React.memo(DiaryEditor); //êµ³ì´ ìœ„ì—ì„œ ê¸´ ì½”ë“œë¥¼ ì „ë¶€ ë¬¶ì§€ ì•Šì•„ë„ ë¨. 
```

**ë‹¨ê³„ 2> React.memo() ì ìš© í›„ ë Œë”ë§ í™•ì¸í•´ë³´ê¸°**

ì½˜ì†”ì— â€˜ë‹¤ì´ì–´ë¦¬ ì—ë””í„° ë Œë”â€™ê°€ 2ë²ˆ ì°í˜ = DiaryEditorê°€ ë‘ ë²ˆ ë Œë” ë¨ (ìµœì í™” x) 

â†’ App.jsì˜ ì½”ë“œ í™•ì¸

**ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë˜ëŠ” ê²½ìš°**

1. ë³¸ì¸ì´ ê°€ì§„ stateì˜ ê°’ì´ ë³€í•˜ëŠ” ê²½ìš°

2. ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë˜ëŠ” ê²½ìš°

3.ìì‹ ì´ ë°›ì€ propì´ ë³€ê²½ë˜ëŠ” ê²½ìš°

App ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë˜ë©´ì„œ DiaryEditorë„ ë Œë”ë§ ë¨ (dataê°€ ë¹ˆ ë°°ì—´ì¸ ìƒíƒœì—ì„œ)

ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ë˜ëŠ” ì‹œì ì— í˜¸ì¶œí•œ getData()í•¨ìˆ˜ì—ì„œ setData()í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³ , data stateê°€ ë°”ë€Œê²Œ ë˜ë©´ì„œ Appì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ ë¨. 

â‡’ App ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ë˜ìë§ˆì 2ë²ˆì˜ ë Œë”ë§ì´ ì¼ì–´ë‚˜ì„œ DiaryEditorì˜ propìœ¼ë¡œ ì „ë‹¬ë˜ëŠ” onCreateí•¨ìˆ˜ë„ ë‹¤ì‹œ ìƒì„±ë¨. onCreate í•¨ìˆ˜ ì•ˆì˜ ê°’ë“¤ì€ ì¬ìƒì„±ë˜ì–´ë„ ë˜‘ê°™ì€ ê°’ì„ ê°–ì§€ë§Œ, ë¹„ì›ì‹œ íƒ€ì… ìë£Œí˜•ì´ê¸° ë•Œë¬¸ì— ì–•ì€ ë¹„êµë¥¼ í•˜ê²Œ ë˜ì–´, ë Œë”ë§ì´ ì¼ì–´ë‚˜ëŠ” ê²ƒ.

ê²°ë¡ : App ì»´í¬ë„ŒíŠ¸ì˜ onCreateí•¨ìˆ˜ê°€ ì¬ìƒì„±ë˜ì§€ ì•Šì•„ì•¼ DiaryEditorë¥¼ React.memoë¡œ ìµœì í™” í•  ìˆ˜ ìˆìŒ.

â†’ onCreateê°€ ì¬ìƒì„±ë˜ì§€ ì•Šê²Œí•˜ë ¤ í•  ë•Œ ê³ ë ¤í•  ìˆ˜ ìˆëŠ” ë°©ë²• 

1) **useMemo** â†’ ê·¸ëŸ¬ë‚˜ useMemoëŠ” dependency arrayë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë©”ëª¨ì´ì œì´ì…˜ì„ ë„ì™€ì£¼ëŠ” ê¸°ëŠ¥ì´ì§€ë§Œ,  í•¨ìˆ˜ê°€ ì•„ë‹ˆë¼ ê°’ì„ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ.

2)**useCallback** - ë©”ëª¨ì´ì œì´ì…˜ëœ ì½œë°±í•¨ìˆ˜ë¥¼ ë°˜í™˜.

```jsx
ì‚¬ìš© ë°©ë²•
const memoizedCallback = useCallback(()=>{
	dosomething(a,b);
},
[a,b], //ì˜ì¡´ì„± ë°°ì—´ì˜ ê°’ì´ ë³€í•˜ì§€ ì•Šìœ¼ë©´ ì½œë°±í•¨ìˆ˜ë„ ì¬ìƒì„±ë˜ì§€ ì•ŠìŒ.
);
```

onCreate()ì— useCallback ì ìš©

```jsx
import { useState, useRef, useEffect, useMemo, useCallback } from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const App = () => {
  const [data, setData] = useState([]);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());

    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    setData(initData);
  };

  useEffect(() => {
    getData();
  }, []);

  const onCreate = useCallback((author, content, emotion) => {
    const created_date = new Date().getTime();
    const newItem = {
      author,
      content,
      emotion,
      created_date: created_date,
      id: dataId.current,
    };
    dataId.current += 1;
    setData([newItem, ...data]);
  },[]);

  const onEdit = (targetId, newContent) => {
    setData(
      data.map((it) =>
        it.id === targetId ? { ...it, content: newContent } : it
      )
    );
  };

  const onRemove = (targetId) => {
    const newDiaryList = data.filter((it) => it.id !== targetId);
    setData(newDiaryList);
  };

  const getDiaryAnalysis = useMemo(() => {
    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100;
    return { goodCount, badCount, goodRatio };
  }, [data.length]);

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis;
  return (
    <div className="App">
      <DiaryEditor onCreate={onCreate} />
      <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
      <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
      <DiaryList diaryList={data} onRemove={onRemove} onEdit={onEdit} />
    </div>
  );
};
export default App;
```

ì ìš©í•˜ê³  ìƒˆë¡œìš´ ì¼ê¸°ë¥¼ ì‘ì„±í•˜ë©´ ëª¨ë“  ì¼ê¸°ê°€ ì‚¬ë¼ì§€ê³  ë°©ê¸ˆ ì‘ì„±í•œ ì¼ê¸°ë§Œ ì¡´ì¬í•¨. 

â†’dependency arrayì— ì•„ë¬´ ê°’ë„ ë„£ì§€ ì•Šì•„ì„œ

**ë¬¸ì œ ìƒí™©**

useCallbackìœ¼ë¡œ ê°ì‹¼ onCreateí•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ ë˜ëŠ” ì‹œì ì— í•œë²ˆë§Œ ìƒì„±ë˜ê³  ê·¸ ë‹¹ì‹œ data stateëŠ” ë¹ˆ ë°°ì—´ì„.  

ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œ í•¨ìˆ˜ê°€ ë‹¤ì‹œ ìƒì„±ë˜ëŠ” ì´ìœ ëŠ” í˜„ì¬ stateê°’ì„ ì°¸ì¡°í•˜ê¸° ìœ„í•´ì„œì¸ë° onCreate í•¨ìˆ˜ëŠ” ì½œë°± ì•ˆì— ê°‡í˜€ì„œ í˜„ì¬ì˜ data stateë¥¼ ì°¸ì¡°í•˜ì§€ ëª»í•˜ê³  ë¹ˆ ë°°ì—´ì„ ì „ë‹¬ í•¨. 

**ê³ ë ¤í•  ìˆ˜ ìˆëŠ” í•´ê²° ë°©ë²•**

1) ì˜ì¡´ì„± ë°°ì—´ì— data ì „ë‹¬ 

ê·¸ëŸ¬ë‚˜, data ê°’ì´ ë°”ë€Œë©´ í•¨ìˆ˜ê°€ ì¬ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ê²°ë¡ ì ìœ¼ë¡œ ì›í•˜ëŠ” ë™ì‘ì„ í•  ìˆ˜ ì—†ìŒ

dataê°€ ë°”ë€Œì–´ë„ onCreate()ê°€ ì¬ìƒì„±ë˜ì§€ ì•Šê¸¸ ë°”ëŒ. ê·¸ëŸ¬ë‚˜ onCreate()ê°€ ì¬ìƒì„±ë˜ì§€ ì•Šìœ¼ë©´ ìµœì‹ ì˜ data stateê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ì–´ì„œ ì´ìƒí•œ ë™ì‘ì„ í•˜ê²Œ ë¨. â†’ë”œë ˆë§ˆ

2)í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸ ì‚¬ìš©.  

í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸ëŠ” ìƒíƒœ ë³€í™” í•¨ìˆ˜ì— í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒ

â†’í™”ì‚´í‘œ í•¨ìˆ˜ì˜ ì „ë‹¬ ì¸ìë¡œ dataë¥¼ ì£¼ê³  ì•„ì´í…œì„ ì¶”ê°€í•œ  dataë¥¼ ë°˜í™˜í•˜ëŠ” ì½œë°±ì„ setDataì— ì „ë‹¬

â†’ dependency arrayë¥¼ ë¹„ì›Œë„ í•­ìƒ ìµœì‹ ì˜ stateë¥¼ ì¸ìë¥¼ í†µí•´ ì°¸ê³ í•  ìˆ˜ ìˆì–´ì„œ depsë¥¼ ë¹„ìš¸ ìˆ˜ ìˆìŒ.

```jsx
import { useState, useRef, useEffect, useMemo, useCallback } from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const App = () => {
  const [data, setData] = useState([]);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());

    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    setData(initData);
  };

  useEffect(() => {
    getData();
  }, []);

  const onCreate = useCallback((author, content, emotion) => {
    const created_date = new Date().getTime();
    const newItem = {
      author,
      content,
      emotion,
      created_date: created_date,
      id: dataId.current,
    };
    dataId.current += 1;
    setData((data) => [newItem, ...data]);
  }, []);

  const onEdit = (targetId, newContent) => {
    setData(
      data.map((it) =>
        it.id === targetId ? { ...it, content: newContent } : it
      )
    );
  };

  const onRemove = (targetId) => {
    const newDiaryList = data.filter((it) => it.id !== targetId);
    setData(newDiaryList);
  };

  const getDiaryAnalysis = useMemo(() => {
    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100;
    return { goodCount, badCount, goodRatio };
  }, [data.length]);

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis;
  return (
    <div className="App">
      <DiaryEditor onCreate={onCreate} />
      <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
      <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
      <DiaryList diaryList={data} onRemove={onRemove} onEdit={onEdit} />
    </div>
  );
};
export default App;
```

ì •ë¦¬> ë¶ˆí•„ìš”í•œ ë Œë”ë§ì´ ì¼ì–´ë‚˜ëŠ” ê²ƒ í™•ì¸ â†’ DiaryEditorë¥¼ React.memo()ë¡œ ë©”ëª¨ì´ì œì´ì…˜â†’ propìœ¼ë¡œ ì „ë‹¬í•œ onCreate()í•¨ìˆ˜ê°€ ì¬ìƒì„±ë˜ê¸° ë•Œë¬¸ì— React.memo()ë¡œ ë©”ëª¨ì´ì œì´ì…˜í•œ íš¨ê³¼ë¥¼ ë³¼ ìˆ˜ ì—†ì—ˆìŒ â†’ onCreate()í•¨ìˆ˜ë¥¼ ìµœì í™”í•˜ê¸° ìœ„í•´ useCallbackì„ ì‚¬ìš©í–ˆìœ¼ë‚˜ í˜„ì¬ data stateë¥¼ë°˜ì˜í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œ ë°œìƒ â†’ í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸ë¡œ í•´ê²°

## ìµœì í™”4 - ìµœì í™” ì™„ì„±

ê·¸ë™ì•ˆ ìµœì í™” ê¸°ìˆ ì„ ì‘ìš©í•´ í”„ë¡œì íŠ¸ ì „ë°˜ì„ ìµœì í™” 

1> DiaryItem í•˜ë‚˜ë§Œ ì‚­ì œí•´ë„ ë‚˜ë¨¸ì§€ Itemë“¤ì´ ë‹¤ ë¦¬ë Œë”ë§

ë¦¬ë Œë”ë˜ëŠ” ê²ƒ í™•ì¸í•˜ëŠ” ì½”ë“œ

```jsx
import React, { useState, useRef, useEffect } from "react";

const DiaryItem = ({
  id,
  author,
  content,
  emotion,
  created_date,
  onRemove,
  onEdit,
}) => {
  useEffect(() => {
    console.log(`${id}ë²ˆì§¸ ì•„ì´í…œ ë Œë”!`);
  });
  const localContentInput = useRef();

  const [isEdit, setIsEdit] = useState(false);
  const [localContent, setLocalContent] = useState(content);

  const handleRemove = () => {
    if (window.confirm(`${id}ë²ˆì§¸ ì¼ê¸°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
      onRemove(id);
    }
  };

  const toggleIsEdit = () => {
    setIsEdit(!isEdit);
  };

  const HandleQuitEdit = () => {
    setIsEdit(false);
    setLocalContent(content);
  };

  const handleEdit = () => {
    if (localContent.length < 5) {
      localContentInput.current.focus();
      return;
    }
    if (window.confirm(`${id}ë²ˆì§¸ ì¼ê¸°ë¥¼ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
      onEdit(id, localContent);
      toggleIsEdit();
    }
  };

  return (
    <div className="DiaryItem">
      <div className="Info">
        <span>
          ì‘ì„±ì : {author} | ê°ì • ì ìˆ˜ : {emotion} |
        </span>
        <br />
        <div className="Date">
          ì‘ì„±ëœ ë‚ ì§œ : {new Date(created_date).toLocaleString()}
        </div>
      </div>
      <div className="Content">
        {isEdit ? (
          <textarea
            ref={localContentInput}
            value={localContent}
            onChange={(e) => {
              setLocalContent(e.target.value);
            }}
          />
        ) : (
          content
        )}
      </div>
      <div>
        {isEdit ? (
          <>
            <button onClick={HandleQuitEdit}>ìˆ˜ì • ì·¨ì†Œ</button>
            <button onClick={handleEdit}>ìˆ˜ì • ì™„ë£Œ</button>
          </>
        ) : (
          <>
            <button onClick={handleRemove}>ì‚­ì œí•˜ê¸°</button>
            <button onClick={toggleIsEdit}>ìˆ˜ì •í•˜ê¸°</button>
          </>
        )}
      </div>
    </div>
  );
};
export default React.memo(DiaryItem);
```

ì½˜ì†”ì— idê°€ 0ë¶€í„° 19ì¸ ì•„ì´í…œì´ ë‹¤ì‹œ ë Œë”ë§ ë¨.

DiaryItemì´ ë°›ëŠ” propì€ onEdit, onRemove, id, author, content, emotion, created_dateì¸ë° content, onEdit,onRemoveë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ propì€ ë³€í•˜ì§€ ì•ŠëŠ” ê°’

onEditê³¼ onRemoveëŠ” onCreateë¥¼ ìµœì í™”í•œ ê²ƒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ìµœì í™”

```jsx
import { useState, useRef, useEffect, useMemo, useCallback } from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const App = () => {
  const [data, setData] = useState([]);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());

    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    setData(initData);
  };

  useEffect(() => {
    setTimeout(() => {
      getData();
    }, 1500);
  }, []);

  const onCreate = useCallback((author, content, emotion) => {
    const created_date = new Date().getTime();
    const newItem = {
      author,
      content,
      emotion,
      created_date: created_date,
      id: dataId.current,
    };
    dataId.current += 1;
    setData((data) => [newItem, ...data]);
  }, []);

  const onEdit = useCallback((targetId, newContent) => {
    setData((data) =>
      data.map((it) =>
        it.id === targetId ? { ...it, content: newContent } : it
      )
    );
  }, []);

  const onRemove = useCallback((targetId) => {
    setData(data.filter((it) => it.id !== targetId));
  });

  const getDiaryAnalysis = useMemo(() => {
    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100;
    return { goodCount, badCount, goodRatio };
  }, [data.length]);

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis;
  return (
    <div className="App">
      <DiaryEditor onCreate={onCreate} />
      <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
      <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
      <DiaryList diaryList={data} onRemove={onRemove} onEdit={onEdit} />
    </div>
  );
};
export default App;
```

ì½˜ì†”ë¡œ í™•ì¸â†’ë°©ê¸ˆ ì¶”ê°€í•œ ì•„ì´í…œë§Œ ë Œë”ë§ë¨.

## ë³µì¡í•œ ìƒíƒœ ê´€ë¦¬ ë¡œì§ ë¶„ë¦¬í•˜ê¸° - useReducer

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%206.png)

App ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœê´€ë¦¬ ë¡œì§ì´ ì œì¼ ë³µì¡í–ˆìŒ.

*ìƒíƒœ ë³€í™” í•¨ìˆ˜ë“¤ì€ ìƒíƒœë¥¼ updateí•˜ê¸° ìœ„í•´ì„  ê¸°ì¡´ì˜ stateë¥¼ ì°¸ì¡°í•´ì•¼í–ˆê¸° ë•Œë¬¸ì— ì»´í¬ë„ŒíŠ¸ ë‚´ì—ë§Œ ì¡´ì¬í•´ì•¼ í–ˆìŒ.*

ì»´í¬ë„ŒíŠ¸ ë‚´ ì½”ë“œê°€ ê¸¸ì–´ì§€ê³  ë¬´ê±°ì›Œì§€ëŠ” ê²ƒì€ ì¢‹ì§€ ì•ŠìŒ. 

useReducer = ìƒíƒœë³€í™” ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶„ë¦¬í•˜ëŠ” ê¸°ëŠ¥

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%207.png)

ì´ ì½”ë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%208.png)

useReducerê¸°ëŠ¥ì„ í†µí•´ ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ë¡œ ìƒíƒœ ë³€í™”ë¡œì§ì„ ë¶„ë¦¬í•˜ì—¬ë§ˆì¹˜ switch-caseë¬¸ì²˜ëŸ¼ ì‚¬ìš© í•  ìˆ˜ ìˆìŒ.

<aside>
ğŸ’¡ useReducerë¥¼ ì‚¬ìš©í•  ë• ë¹„êµ¬ì¡°í™” í• ë‹¹, ë°°ì—´ì˜ ì²«ë²ˆì§¸ ê°’ì€ state, ë‘ë²ˆì§¸ ê°’ì€ ê¼­ dispatchë¡œ ì „ë‹¬í•´ì•¼ í•¨. ê·¸ë¦¬ê³  () ì•ˆì—ëŠ” reducerì™€ ì´ˆê¸° ìƒíƒœë¥¼ ì „ë‹¬í•œë‹¤.

</aside>

App.jsì— ì ìš©í•´ë³´ê¸°

```jsx
import { useRef, useEffect, useMemo, useCallback, useReducer } from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const reducer = (state, action) => {
  switch (action.type) {
    case "INIT": {
      return action.data;
    }
    case "CREATE": {
      const created_date = new Date().getTime();
      const newItem = {
        ...action.data,
        created_date,
      };
      return [newItem, ...state];
    }
    case "REMOVE": {
      return state.filter((it) => it.id !== action.targetId);
    }
    case "EDIT": {
      return state.map((it) =>
        it.id === action.targetId ? { ...it, content: action.newContent } : it
      );
    }
    default:
      return state;
  }
};

const App = () => {
  //const [data, setData] = useState([]);
  const [data, dispatch] = useReducer(reducer, []);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());

    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    dispatch({ type: "INIT", data: initData });
  };

  useEffect(() => {
    setTimeout(() => {
      getData();
    }, 1500);
  }, []);

  const onCreate = useCallback((author, content, emotion) => {
    dispatch({
      type: "CREATE",
      data: { author, content, emotion, id: dataId.current },
    });

    dataId.current += 1;
  }, []);

  const onEdit = useCallback((targetId, newContent) => {
    dispatch({ type: "EDIT", targetId, newContent });
  }, []);

  const onRemove = useCallback((targetId) => {
    dispatch({ type: "REMOVE", targetId });
  });

  const getDiaryAnalysis = useMemo(() => {
    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100.0;
    return { goodCount, badCount, goodRatio };
  }, [data.length]);

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis;
  return (
    <div className="App">
      <DiaryEditor onCreate={onCreate} />
      <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
      <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
      <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
      <DiaryList diaryList={data} onRemove={onRemove} onEdit={onEdit} />
    </div>
  );
};
export default App;
```

ì£¼ì˜) switch-caseì—ëŠ” ë°˜ë“œì‹œ default caseë¥¼ ì ì–´ì¤˜ì•¼ í•¨.  reducerëŠ” í•­ìƒ ìƒˆë¡œìš´ ìƒíƒœë¥¼ ë°˜í™˜í•´ì¤˜ì•¼ í•¨. 

useReducer í•¨ìˆ˜ë¥¼ ì´ìš©í•  ë•Œ ìƒíƒœ ë³€í™”ë¥¼ ì¼ìœ¼í‚¤ëŠ” í•¨ìˆ˜ë¥¼ dispatchë¡œ ì¼ì—ˆëŠ”ë° dispatchëŠ”í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸ í•„ìš”ì—†ì´ í˜„ì¬ stateë¥¼ ìë™ìœ¼ë¡œ ì°¸ì¡°í•˜ê¸° ë•Œë¬¸ì— useCallbackì˜ ì˜ì¡´ì„±ë°°ì—´ì„ ê±±ì •í•˜ì§€ ì•Šì•„ë„ ë¨.

## ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì— ë°ì´í„° ê³µê¸‰í•˜ê¸° - Context

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%209.png)

í”„ë¡œì íŠ¸ì˜ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬

ë‹¨ë°©í–¥ ë°ì´í„° íë¦„ ë•Œë¬¸ì— props drilling ë¬¸ì œ ë°œìƒ 

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%2010.png)

Provider ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•˜ë©´ ì§í†µìœ¼ë¡œ propì„ ì „ë‹¬í•  ìˆ˜ ìˆìŒ.

â‡’Context ì´ìš© 

![Untitled](%E1%84%92%E1%85%A1%E1%86%AB%E1%84%8B%E1%85%B5%E1%86%B8%20%E1%84%8F%E1%85%B3%E1%84%80%E1%85%B5%E1%84%85%E1%85%A9%20%E1%84%8C%E1%85%A1%E1%86%AF%E1%84%85%E1%85%A1%E1%84%86%E1%85%A5%E1%86%A8%E1%84%82%E1%85%B3%E1%86%AB%20%E1%84%85%E1%85%B5%E1%84%8B%E1%85%A2%E1%86%A8%E1%84%90%E1%85%B3%20(React%20js)%20be6a156c153f48049f84c633fc175ed7/Untitled%2011.png)

ë‹¨ê³„ 1> Context ìƒì„±í•˜ê³  Providerë¡œ ë°ì´í„° ê³µê¸‰í•˜ê¸°

```jsx
import React, {
  useRef,
  useEffect,
  useMemo,
  useCallback,
  useReducer,
} from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const reducer = (state, action) => {
  switch (action.type) {
    case "INIT": {
      return action.data;
    }
    case "CREATE": {
      const created_date = new Date().getTime();
      const newItem = {
        ...action.data,
        created_date,
      };
      return [newItem, ...state];
    }
    case "REMOVE": {
      return state.filter((it) => it.id !== action.targetId);
    }
    case "EDIT": {
      return state.map((it) =>
        it.id === action.targetId ? { ...it, content: action.newContent } : it
      );
    }
    default:
      return state;
  }
};

export const DiaryStateContext = React.createContext();

const App = () => {
  //const [data, setData] = useState([]);
  const [data, dispatch] = useReducer(reducer, []);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());

    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    dispatch({ type: "INIT", data: initData });
  };

  useEffect(() => {
    setTimeout(() => {
      getData();
    }, 1500);
  }, []);

  const onCreate = useCallback((author, content, emotion) => {
    dispatch({
      type: "CREATE",
      data: { author, content, emotion, id: dataId.current },
    });

    dataId.current += 1;
  }, []);

  const onEdit = useCallback((targetId, newContent) => {
    dispatch({ type: "EDIT", targetId, newContent });
  }, []);

  const onRemove = useCallback((targetId) => {
    dispatch({ type: "REMOVE", targetId });
  }, []);

  const getDiaryAnalysis = useMemo(() => {
    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100.0;
    return { goodCount, badCount, goodRatio };
  }, [data.length]);

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis;
  return (
    <DiaryStateContext.Provider value={data}>
      <div className="App">
        <DiaryEditor onCreate={onCreate} />
        <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
        <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
        <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
        <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
        <DiaryList diaryList={diaryList} onRemove={onRemove} onEdit={onEdit} />
      </div>
    </DiaryStateContext.Provider>
  );
};
export default App;
```

contextë¥¼ exportí•´ì¤˜ì•¼ í•¨.

export defaultëŠ” íŒŒì¼ í•˜ë‚˜ë‹¹ í•˜ë‚˜ë§Œ ì“¸ ìˆ˜ ìˆì§€ë§Œ exportëŠ” ì—¬ëŸ¬ ê°œ ì“¸ ìˆ˜ ìˆìŒ. 

importí•˜ëŠ” ê¸°ëŠ¥ë“¤ ì¤‘ì—ì„œ ReactëŠ” ì¤‘ê´„í˜¸ ì—†ì´ Reactë§Œ importí•˜ì§€ë§Œ ë‹¤ë¥¸ í›…ë“¤ì€ ë¹„êµ¬ì¡°í™”í• ë‹¹ì„ í†µí•´ì„œ importí•¨ 

ReactëŠ” export defaultë¡œ ë‚´ë³´ëƒˆê³ , ë‚˜ë¨¸ì§€ í›…ë“¤ì€ export constë¡œ ë‚´ë³´ëƒˆê¸° ë•Œë¬¸

DiaryListì˜ ì½”ë“œë„ ìˆ˜ì •

```jsx
import { useContext } from "react";
import DiaryItem from "./DiaryItem";
import { DiaryStateContext } from "./App";

const DiaryList = ({ onRemove, onEdit }) => {
  const diaryList = useContext(DiaryStateContext);
  return (
    <div className="DiaryList">
      <h2>ì¼ê¸° ë¦¬ìŠ¤íŠ¸</h2>
      <h4>{diaryList.length}ê°œì˜ ì¼ê¸°ê°€ ìˆìŠµë‹ˆë‹¤.</h4>
      <div>
        {diaryList.map((it) => (
          <DiaryItem key={it.id} {...it} onRemove={onRemove} onEdit={onEdit} />
        ))}
      </div>
    </div>
  );
};

DiaryList.defaultProps = { diaryList: [] };
export default DiaryList;
```

ë¨¼ì €, useContext í›… importí•˜ê³ , diaryListë¥¼ propì´ ì•„ë‹Œ ì»´í¬ë„ŒíŠ¸ì˜ ë‚´ë¶€ì˜ ìƒìˆ˜ë¡œ ì´ˆê¸°í™”

DiaryStateContextë„ importí•´ì¤˜ì•¼ í•¨.

ì´í›„ì— App.jsì˜ ì½”ë“œ ì¤‘ diaryListë¥¼ propìœ¼ë¡œ ë„˜ê²¨ì£¼ëŠ” ë¶€ë¶„ì„  ìˆ˜ì •í•´ì•¼ í•¨.

```jsx
import React, {
  useRef,
  useEffect,
  useMemo,
  useCallback,
  useReducer,
} from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const reducer = (state, action) => {
  switch (action.type) {
    case "INIT": {
      return action.data;
    }
    case "CREATE": {
      const created_date = new Date().getTime();
      const newItem = {
        ...action.data,
        created_date,
      };
      return [newItem, ...state];
    }
    case "REMOVE": {
      return state.filter((it) => it.id !== action.targetId);
    }
    case "EDIT": {
      return state.map((it) =>
        it.id === action.targetId ? { ...it, content: action.newContent } : it
      );
    }
    default:
      return state;
  }
};

export const DiaryStateContext = React.createContext();

const App = () => {
  //const [data, setData] = useState([]);
  const [data, dispatch] = useReducer(reducer, []);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());

    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    dispatch({ type: "INIT", data: initData });
  };

  useEffect(() => {
    setTimeout(() => {
      getData();
    }, 1500);
  }, []);

  const onCreate = useCallback((author, content, emotion) => {
    dispatch({
      type: "CREATE",
      data: { author, content, emotion, id: dataId.current },
    });

    dataId.current += 1;
  }, []);

  const onEdit = useCallback((targetId, newContent) => {
    dispatch({ type: "EDIT", targetId, newContent });
  }, []);

  const onRemove = useCallback((targetId) => {
    dispatch({ type: "REMOVE", targetId });
  }, []);

  const getDiaryAnalysis = useMemo(() => {
    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100.0;
    return { goodCount, badCount, goodRatio };
  }, [data.length]);

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis;
  return (
    <DiaryStateContext.Provider value={data}>
      <div className="App">
        <DiaryEditor onCreate={onCreate} />
        <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
        <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
        <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
        <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
        <DiaryList onRemove={onRemove} onEdit={onEdit} />
      </div>
    </DiaryStateContext.Provider>
  );
};
export default App;
```

ê·¸ë ‡ë‹¤ë©´ onCreate, onEdit, onRemoveë„ Providerë¥¼ í†µí•´ì„œ propìœ¼ë¡œ ë‚´ë ¤ì¤„ ìˆ˜ ìˆì„ê¹Œ?

â‡’ Provider ë˜í•œ ì»´í¬ë„ŒíŠ¸ê¸° ë•Œë¬¸ì— propì´ ë°”ë€Œë©´ Provider ì»´í¬ë„ŒíŠ¸ê°€ ì¬ìƒì„±ë˜ê³ , ì´ë ‡ê²Œ ë˜ë©´ ë°‘ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ ë˜í•œ ì¬ìƒì„±ë˜ëŠ” ë¬¸ì œê°€ ìƒê¹€ (ë§Œë“¤ì–´ë‘ì—ˆë˜ ìµœì í™”ê°€ ë‹¤ í’€ë¦¬ê²Œ ë¨)

â†’Contextë¥¼ ì¤‘ì²©í•´ì„œ ì‚¬ìš©

```jsx
import React, {
  useRef,
  useEffect,
  useMemo,
  useCallback,
  useReducer,
} from "react";
import "./App.css";

import DiaryEditor from "./DiaryEditor";
import DiaryList from "./DiaryList";

const reducer = (state, action) => {
  switch (action.type) {
    case "INIT": {
      return action.data;
    }
    case "CREATE": {
      const created_date = new Date().getTime();
      const newItem = {
        ...action.data,
        created_date,
      };
      return [newItem, ...state];
    }
    case "REMOVE": {
      return state.filter((it) => it.id !== action.targetId);
    }
    case "EDIT": {
      return state.map((it) =>
        it.id === action.targetId ? { ...it, content: action.newContent } : it
      );
    }
    default:
      return state;
  }
};

export const DiaryStateContext = React.createContext();
export const DiaryDispatchContext = React.createContext();

const App = () => {
  //const [data, setData] = useState([]);
  const [data, dispatch] = useReducer(reducer, []);

  const dataId = useRef(0);

  const getData = async () => {
    const res = await fetch(
      "https://jsonplaceholder.typicode.com/comments"
    ).then((res) => res.json());

    const initData = res.slice(0, 20).map((it) => {
      return {
        author: it.email,
        content: it.body,
        emotion: Math.floor(Math.random() * 5) + 1,
        created_date: new Date().getTime(),
        id: dataId.current++,
      };
    });
    dispatch({ type: "INIT", data: initData });
  };

  useEffect(() => {
    setTimeout(() => {
      getData();
    }, 1500);
  }, []);

  const onCreate = useCallback((author, content, emotion) => {
    dispatch({
      type: "CREATE",
      data: { author, content, emotion, id: dataId.current },
    });

    dataId.current += 1;
  }, []);

  const onEdit = useCallback((targetId, newContent) => {
    dispatch({ type: "EDIT", targetId, newContent });
  }, []);

  const onRemove = useCallback((targetId) => {
    dispatch({ type: "REMOVE", targetId });
  }, []);

  const memoizedDispatches = useMemo(() => {
    return { onCreate, onEdit, onRemove };
  }, []); //useMemoë¡œ ê°ì‹¸ì§€ ì•Šìœ¼ë©´ App ì»´í¬ë„ŒíŠ¸ê°€ ì¬ìƒì„±ë  ë•Œ {onCreate,onEdit,onRemove}ë„ ì¬ìƒì„±ë˜ê¸° ë•Œë¬¸

  const getDiaryAnalysis = useMemo(() => {
    const goodCount = data.filter((it) => it.emotion >= 3).length;
    const badCount = data.length - goodCount;
    const goodRatio = (goodCount / data.length) * 100.0;
    return { goodCount, badCount, goodRatio };
  }, [data.length]);

  const { goodCount, badCount, goodRatio } = getDiaryAnalysis;
  return (
    <DiaryStateContext.Provider value={data}>
      <DiaryDispatchContext.Provider value={memoizedDispatches}>
        <div className="App">
          <DiaryEditor />
          <div>ì „ì²´ ì¼ê¸° : {data.length} </div>
          <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ê°œìˆ˜ : {goodCount}</div>
          <div>ê¸°ë¶„ ë‚˜ìœ ì¼ê¸° ê°œìˆ˜ : {badCount}</div>
          <div>ê¸°ë¶„ ì¢‹ì€ ì¼ê¸° ë¹„ìœ¨ : {goodRatio}</div>
          <DiaryList />
        </div>
      </DiaryDispatchContext.Provider>
    </DiaryStateContext.Provider>
  );
};
export default App;
```

ì´ì œ, DiaryEditorì™€ DiaryList, DiaryItemë„ ìˆ˜ì •

```jsx
import React, { useRef, useState, useContext } from "react";
import { DiaryDispatchContext } from "./App";

const DiaryEditor = () => {
  const { onCreate } = useContext(DiaryDispatchContext);

  const authorInput = useRef();
  const contentInput = useRef();

  const [state, setState] = useState({
    author: "",
    content: "",
    emotion: 1,
  });

  const handleChangeState = (e) => {
    setState({ ...state, [e.target.name]: e.target.value });
  };

  const handleSubmit = () => {
    if (state.author.length < 1) {
      authorInput.current.focus();
      return;
    }
    if (state.content < 5) {
      contentInput.current.focus();
      return;
    }
    onCreate(state.author, state.content, state.emotion);
    alert("ì €ì¥ ì™„ë£Œ");
    setState({ author: "", content: "", emotion: 1 });
  };

  return (
    <div className="DiaryEditor">
      <h2>ì˜¤ëŠ˜ì˜ ì¼ê¸°</h2>
      <div>
        <input
          ref={authorInput}
          name="author"
          value={state.author}
          onChange={handleChangeState}
          placeholder="ì‘ì„±ì"
          type="text"
        />
      </div>
      <div>
        <textarea
          ref={contentInput}
          name="content"
          value={state.content}
          onChange={handleChangeState}
          placeholder="ì¼ê¸°"
          type="text"
        />
      </div>
      <div>
        <span>ì˜¤ëŠ˜ì˜ ê°ì • ì ìˆ˜ : </span>
        <select
          name="emotion"
          value={state.emotion}
          onChange={handleChangeState}
        >
          <option value={1}>1</option>
          <option value={2}>2</option>
          <option value={3}>3</option>
          <option value={4}>4</option>
          <option value={5}>5</option>
        </select>
      </div>
      <div>
        <button onClick={handleSubmit}>ì¼ê¸° ì €ì¥í•˜ê¸°</button>
      </div>
    </div>
  );
};
export default React.memo(DiaryEditor);
```

```jsx
import { useContext } from "react";
import DiaryItem from "./DiaryItem";
import { DiaryStateContext } from "./App";

const DiaryList = () => {
  const diaryList = useContext(DiaryStateContext);

  return (
    <div className="DiaryList">
      <h2>ì¼ê¸° ë¦¬ìŠ¤íŠ¸</h2>
      <h4>{diaryList.length}ê°œì˜ ì¼ê¸°ê°€ ìˆìŠµë‹ˆë‹¤.</h4>
      <div>
        {diaryList.map((it) => (
          <DiaryItem key={it.id} {...it} />
        ))}
      </div>
    </div>
  );
};

DiaryList.defaultProps = { diaryList: [] };
export default DiaryList;
```

```jsx
import React, { useState, useRef, useContext } from "react";
import { DiaryDispatchContext } from "./App";

const DiaryItem = ({ id, author, content, emotion, created_date }) => {
  const { onEdit, onRemove } = useContext(DiaryDispatchContext);

  const localContentInput = useRef();

  const [isEdit, setIsEdit] = useState(false);
  const [localContent, setLocalContent] = useState(content);

  const handleRemove = () => {
    if (window.confirm(`${id}ë²ˆì§¸ ì¼ê¸°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
      onRemove(id);
    }
  };

  const toggleIsEdit = () => {
    setIsEdit(!isEdit);
  };

  const HandleQuitEdit = () => {
    setIsEdit(false);
    setLocalContent(content);
  };

  const handleEdit = () => {
    if (localContent.length < 5) {
      localContentInput.current.focus();
      return;
    }
    if (window.confirm(`${id}ë²ˆì§¸ ì¼ê¸°ë¥¼ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
      onEdit(id, localContent);
      toggleIsEdit();
    }
  };

  return (
    <div className="DiaryItem">
      <div className="Info">
        <span>
          ì‘ì„±ì : {author} | ê°ì • ì ìˆ˜ : {emotion} |
        </span>
        <br />
        <div className="Date">
          ì‘ì„±ëœ ë‚ ì§œ : {new Date(created_date).toLocaleString()}
        </div>
      </div>
      <div className="Content">
        {isEdit ? (
          <textarea
            ref={localContentInput}
            value={localContent}
            onChange={(e) => {
              setLocalContent(e.target.value);
            }}
          />
        ) : (
          content
        )}
      </div>
      <div>
        {isEdit ? (
          <>
            <button onClick={HandleQuitEdit}>ìˆ˜ì • ì·¨ì†Œ</button>
            <button onClick={handleEdit}>ìˆ˜ì • ì™„ë£Œ</button>
          </>
        ) : (
          <>
            <button onClick={handleRemove}>ì‚­ì œí•˜ê¸°</button>
            <button onClick={toggleIsEdit}>ìˆ˜ì •í•˜ê¸°</button>
          </>
        )}
      </div>
    </div>
  );
};
export default React.memo(DiaryItem);
```